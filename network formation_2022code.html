<pre><font color="#007f69">extensions</font><font color="#000000"> [nw]<br /><br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [character<br />            num-links<br />            nationality<br />            nationality_precis<br />            gender<br />            extroversion<br />            agreeableness<br />            openness<br />            extroversion-category<br />            max-links<br />            linked-turtles </font><font color="#5a5a5a">;; New variable to store the names of linked turtles</font><font color="#000000"><br />]<br /><br /></font><font color="#5a5a5a">;;Setup Procedure;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  create-danes<br />  create-internationals<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Create Danes;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> create-danes<br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> num-people </font><font color="#660096">-</font><font color="#000000"> num-internationals [ </font><font color="#5a5a5a">;the number of people that exceeds number of internationals</font><font color="#000000"><br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#5a5a5a">;set random x and y coordinates</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> </font><font color="#5a5a5a">; initial size</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nationality </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">; dane</font><font color="#000000"><br />  </font><font color="#5a5a5a">;  set nationality_precis 1 ; 100% dane</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> gender </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> perc_f) [</font><font color="#963700">1</font><font color="#000000">] [</font><font color="#963700">0</font><font color="#000000">]   </font><font color="#5a5a5a">; if random number less than percentage of females, assign 1: male</font><font color="#000000"><br /><br />         </font><font color="#5a5a5a">; Personality traits</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> extroversion bound-0-2(</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000">  mu_extro sd_extro) </font><font color="#963700">2</font><font color="#000000">)     </font><font color="#5a5a5a">;extroversion</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> agreeableness bound-0-2(</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000">  mu_agree sd_agree) </font><font color="#963700">2</font><font color="#000000">)    </font><font color="#5a5a5a">;agreeableness</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> openness  bound-0-2 (</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> mu_open sd_open) </font><font color="#963700">2</font><font color="#000000">)        </font><font color="#5a5a5a">;opneness</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; List traits</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> character (</font><font color="#660096">list</font><font color="#000000"> nationality  gender extroversion agreeableness openness)<br /><br />        </font><font color="#5a5a5a">; Put extroversion into categories, bound between 0 and 2</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> extroversion-category </font><font color="#660096">ifelse-value</font><font color="#000000"> (extroversion </font><font color="#660096">&lt;</font><font color="#000000"> low_extro_bound) </font><font color="#5a5a5a">;low extroversion</font><font color="#000000"><br />    [</font><font color="#963700">1</font><font color="#000000">]<br />    (</font><font color="#660096">ifelse-value</font><font color="#000000"> (extroversion </font><font color="#660096">&lt;</font><font color="#000000"> mid_extro_bound)                          </font><font color="#5a5a5a">;medium extroversion</font><font color="#000000"><br />        [</font><font color="#963700">2</font><font color="#000000">]<br />        [</font><font color="#963700">3</font><font color="#000000">])                                                               </font><font color="#5a5a5a">;high extroversion</font><font color="#000000"><br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> num-links </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#5a5a5a">;define number of links</font><font color="#000000"><br />    calculate-max-links </font><font color="#5a5a5a">; call function that define max links based on extroversion-category</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> linked-turtles [] </font><font color="#5a5a5a">;; Initialize as empty list </font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Create Internationals;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> create-internationals<br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> num-internationals [<br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#5a5a5a">; set random x and y coordinates</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">  </font><font color="#5a5a5a">; initial size</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nationality </font><font color="#963700">0</font><font color="#000000"> </font><font color="#5a5a5a">; international</font><font color="#000000"><br />   </font><font color="#5a5a5a">; set nationality_precis  (1 + random 9) / 10 ; between 0.1 and 0.9 with 0.1 inclines</font><font color="#000000"><br />                                                </font><font color="#5a5a5a">; distance from 1 can be thought to represent cultural distance</font><font color="#000000"><br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> gender </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">) [</font><font color="#963700">1</font><font color="#000000">] [</font><font color="#963700">0</font><font color="#000000">] </font><font color="#5a5a5a">; gender has a 50% chance of being 1 or 0, male or female</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; Personality traits</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> extroversion  bound-0-2(</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> mu_extro sd_extro) </font><font color="#963700">2</font><font color="#000000">)        </font><font color="#5a5a5a">; extroversion</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> agreeableness bound-0-2(</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> mu_agree sd_agree) </font><font color="#963700">2</font><font color="#000000">)        </font><font color="#5a5a5a">; agreeableness</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> openness bound-0-2(</font><font color="#660096">precision</font><font color="#000000"> (</font><font color="#660096">random-normal</font><font color="#000000"> mu_open sd_open) </font><font color="#963700">2</font><font color="#000000">)             </font><font color="#5a5a5a">; openess</font><font color="#000000"><br /><br />        </font><font color="#5a5a5a">; List traits</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> character (</font><font color="#660096">list</font><font color="#000000"> nationality  gender extroversion agreeableness openness)<br /><br />        </font><font color="#5a5a5a">; Put extroversion into categories, bound between 0 and 2</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> extroversion-category </font><font color="#660096">ifelse-value</font><font color="#000000"> (extroversion </font><font color="#660096">&lt;</font><font color="#000000"> low_extro_bound) </font><font color="#5a5a5a">; low extroversion</font><font color="#000000"><br />    [</font><font color="#963700">1</font><font color="#000000">]<br />    (</font><font color="#660096">ifelse-value</font><font color="#000000"> (extroversion </font><font color="#660096">&lt;</font><font color="#000000"> mid_extro_bound)                          </font><font color="#5a5a5a">; medium extroversion</font><font color="#000000"><br />        [</font><font color="#963700">2</font><font color="#000000">]<br />        [</font><font color="#963700">3</font><font color="#000000">])                                                                </font><font color="#5a5a5a">; high extroversion</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> num-links </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000">  </font><font color="#5a5a5a">; define number of links</font><font color="#000000"><br />    calculate-max-links           </font><font color="#5a5a5a">; call function that define max links based on extroversion-category</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> linked-turtles [] </font><font color="#5a5a5a">;; Initialize as empty list </font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Connect Procedure ;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> connect<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> max-links[  </font><font color="#5a5a5a">; only allow new connections if under the max</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> max-similarity </font><font color="#963700">0</font><font color="#000000">            </font><font color="#5a5a5a">; initialize maximum similarity</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> selected </font><font color="#963700">nobody</font><font color="#000000">             </font><font color="#5a5a5a">; initialize selected turtle</font><font color="#000000"><br /><br />    </font><font color="#0000aa">let</font><font color="#000000"> weighted-list []  </font><font color="#5a5a5a">; create a weighted list for other turtles based on their agreeableness and num-links</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">let</font><font color="#000000"> entries </font><font color="#660096">min</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#660096">ceiling</font><font color="#000000"> ((agreeableness </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> (num-links </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)))</font><font color="#963700">100</font><font color="#000000">) </font><font color="#5a5a5a">; limit the maximum entries a turtle can appear in the list</font><font color="#000000"><br />      </font><font color="#0000aa">repeat</font><font color="#000000"> entries [<br />        </font><font color="#0000aa">set</font><font color="#000000"> weighted-list </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> weighted-list </font><font color="#5a5a5a">; other turtles repediately put themselves in the list according to their number in weighted list</font><font color="#000000"><br />      ]<br />    ]<br /><br />    </font><font color="#0000aa">set</font><font color="#000000"> weighted-list </font><font color="#660096">shuffle</font><font color="#000000"> weighted-list </font><font color="#5a5a5a">; shuffle the list to ensure random selection</font><font color="#000000"><br /><br />      </font><font color="#5a5a5a">;; Connect loop</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> attempts </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">length</font><font color="#000000"> weighted-list </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> attempts </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">] [ </font><font color="#5a5a5a">;attempts to connect is 5</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> candidate </font><font color="#660096">one-of</font><font color="#000000"> weighted-list                </font><font color="#5a5a5a">; choose one from list randomly</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> similarity cosine-similarity character [character] </font><font color="#660096">of</font><font color="#000000"> candidate </font><font color="#5a5a5a">; calculate cosine similarity between self and candidate</font><font color="#000000"><br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> similarity </font><font color="#660096">&gt;</font><font color="#000000"> max-similarity </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> [</font><font color="#660096">my-links</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> candidate </font><font color="#660096">&lt;</font><font color="#000000"> [max-links] </font><font color="#660096">of</font><font color="#000000"> candidate [ </font><font color="#5a5a5a">; select candidate if similarity is greater than 0 and</font><font color="#000000"><br />                                                                                                    </font><font color="#5a5a5a">; has availabe links left</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> max-similarity similarity </font><font color="#5a5a5a">;update max-similarity</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> selected candidate        </font><font color="#5a5a5a">;select candidate</font><font color="#000000"><br />        ]<br /><br />      </font><font color="#0000aa">set</font><font color="#000000"> weighted-list </font><font color="#660096">remove-item</font><font color="#000000"> (</font><font color="#660096">position</font><font color="#000000"> candidate weighted-list) weighted-list </font><font color="#5a5a5a">;remove candidate from the list to prevent reselection</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> attempts attempts </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">;update attemps</font><font color="#000000"><br />    ]<br /><br />      </font><font color="#5a5a5a">;; Final Connection</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> max-similarity </font><font color="#660096">&gt;</font><font color="#000000"> cos_sim_thres[ </font><font color="#5a5a5a">;if similarity is less than threshold</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> max-links[     </font><font color="#5a5a5a">;and turtle has available links</font><font color="#000000"><br />      </font><font color="#0000aa">create-link-with</font><font color="#000000"> selected          </font><font color="#5a5a5a">;create link</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> selected [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">ifelse-value</font><font color="#000000"> ([</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> selected) [</font><font color="#963700">green</font><font color="#000000">] [</font><font color="#963700">grey</font><font color="#000000">] </font><font color="#5a5a5a">;green: in-group ties, grey: out-group ties</font><font color="#000000"><br />        ]<br /><br />      </font><font color="#5a5a5a">;; Further interactions and dynamics</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#660096">distance</font><font color="#000000"> selected<br />      </font><font color="#0000aa">let</font><font color="#000000"> move-distance </font><font color="#963700">0.05</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> dist </font><font color="#5a5a5a">; Move a greater distance if you a more similar</font><font color="#000000"><br />      </font><font color="#0000aa">face</font><font color="#000000"> selected<br />      </font><font color="#0000aa">fd</font><font color="#000000"> move-distance<br />      </font><font color="#0000aa">ask</font><font color="#000000"> selected [<br />       </font><font color="#0000aa">face</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"><br />       </font><font color="#0000aa">fd</font><font color="#000000"> move-distance<br />          ]<br /><br />       </font><font color="#5a5a5a">;; Layout, update size and count links</font><font color="#000000"><br />      </font><font color="#0000aa">layout-spring</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#963700">0.05</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> num-links </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> selected [</font><font color="#0000aa">set</font><font color="#000000"> num-links </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000">]<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> calculate-size<br />          <br />      </font><font color="#5a5a5a">;; Update linked-turtles lists for both turtles</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> linked-turtles </font><font color="#660096">lput</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> selected linked-turtles<br />      </font><font color="#0000aa">ask</font><font color="#000000"> selected [ </font><font color="#0000aa">set</font><font color="#000000"> linked-turtles </font><font color="#660096">lput</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> linked-turtles ] <br />        ]<br />    ]<br />  ]<br />  ]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Calculate size function ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> calculate-size<br /><br />  </font><font color="#5a5a5a">;; Determine size based on the number of connections</font><font color="#000000"><br />   </font><font color="#0000aa">if</font><font color="#000000"> (num-links </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> num-links </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"><br />  ]<br />  (</font><font color="#0000aa">ifelse</font><font color="#000000"> num-links </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> num-links </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0.7</font><font color="#000000"><br />      ])<br />  (</font><font color="#0000aa">ifelse</font><font color="#000000"> num-links </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> num-links </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0.9</font><font color="#000000"><br />      ])<br />  (</font><font color="#0000aa">ifelse</font><font color="#000000"> num-links </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> num-links </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">15</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">1.1</font><font color="#000000"><br />      ])<br />  (</font><font color="#0000aa">ifelse</font><font color="#000000"> num-links </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">15</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> num-links </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">1.3</font><font color="#000000"><br />      ]<br />    [</font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000">]<br />    )<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;; Report mean links based on extroversion category ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> calculate-mean-links [category]<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">ifelse-value</font><font color="#000000"> (category </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)<br />    [</font><font color="#963700">4</font><font color="#000000">]                                  </font><font color="#5a5a5a">; low extroversion</font><font color="#000000"><br />    (</font><font color="#660096">ifelse-value</font><font color="#000000"> (category </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />      [</font><font color="#963700">11.67</font><font color="#000000">]                                </font><font color="#5a5a5a">; medium extroversion</font><font color="#000000"><br />      [</font><font color="#963700">9.75</font><font color="#000000">])                              </font><font color="#5a5a5a">; high extroversion</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Report sd links based on extroversion category ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> calculate-sd-links [category]<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">ifelse-value</font><font color="#000000"> (category </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)<br />    [</font><font color="#963700">2</font><font color="#000000">]                                 </font><font color="#5a5a5a">; low extroversion</font><font color="#000000"><br />    (</font><font color="#660096">ifelse-value</font><font color="#000000"> (category </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />      [</font><font color="#963700">8.63</font><font color="#000000">]                               </font><font color="#5a5a5a">; medium extroversion</font><font color="#000000"><br />    [</font><font color="#963700">3.10</font><font color="#000000">])                                </font><font color="#5a5a5a">;high extroversion</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;; Calculate max links based on extroversion category ;;</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> calculate-max-links<br />  </font><font color="#0000aa">let</font><font color="#000000"> mean-links calculate-mean-links extroversion-category<br />  </font><font color="#0000aa">let</font><font color="#000000"> sd-links calculate-sd-links extroversion-category<br />  </font><font color="#0000aa">let</font><font color="#000000"> raw-links </font><font color="#660096">random-normal</font><font color="#000000"> mean-links sd-links  </font><font color="#5a5a5a">; calculate n links based on mean and sd</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> max-links </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">round</font><font color="#000000"> raw-links)       </font><font color="#5a5a5a">; round to nearest integer and ensure non-negative</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;; Bound value between 0 and 2 ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> bound-0-2 [value]<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> (</font><font color="#660096">min</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> value </font><font color="#963700">2</font><font color="#000000">)))<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;; Cosine similarity function ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> cosine-similarity [vec1 vec2]<br />  </font><font color="#0000aa">let</font><font color="#000000"> dot-product </font><font color="#660096">sum</font><font color="#000000"> (</font><font color="#660096">map</font><font color="#000000"> [ [a b] -&gt; a </font><font color="#660096">*</font><font color="#000000"> b ] vec1 vec2)<br />  </font><font color="#0000aa">let</font><font color="#000000"> magnitude1 </font><font color="#660096">sqrt</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> (</font><font color="#660096">map</font><font color="#000000"> [x -&gt; x </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] vec1))<br />  </font><font color="#0000aa">let</font><font color="#000000"> magnitude2 </font><font color="#660096">sqrt</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> (</font><font color="#660096">map</font><font color="#000000"> [x -&gt; x </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] vec2))<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> (magnitude1 </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> magnitude2 </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [   </font><font color="#5a5a5a">; report 0 if either magnitude is 0 to ensure output</font><font color="#000000"><br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">report</font><font color="#000000"> dot-product </font><font color="#660096">/</font><font color="#000000"> (magnitude1 </font><font color="#660096">*</font><font color="#000000"> magnitude2)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">;;; Coefficient Calculations ;;;</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; Global clustering coefficient ;;</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> global-clustering-coefficient<br />  </font><font color="#0000aa">let</font><font color="#000000"> closed-triplets </font><font color="#660096">sum</font><font color="#000000"> [ nw:clustering-coefficient </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> triplets </font><font color="#660096">sum</font><font color="#000000"> [ </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">report</font><font color="#000000"> closed-triplets </font><font color="#660096">/</font><font color="#000000"> triplets<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;layout-spring definitions;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;- 0.1: spring-constant is a measure of the &quot;tautness&quot; of the spring.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;       It is the &quot;resistance&quot; to change in their length.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;       spring-constant is the force the spring would exert if it's length were changed by 1 unit.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;- 1: spring-length is the &quot;zero-force&quot; length or the natural length of the springs.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;     This is the length which all springs try to achieve either by pushing out their nodes or pulling them in.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;- 2: repulsion-constant is a measure of repulsion between the nodes.</font><font color="#000000"><br /></font><font color="#5a5a5a">;;     It is the force that 2 nodes at a distance of 1 unit will exert on each other.</font>
</pre>
